<?xml version="1.0" encoding="utf-8" ?>
<!--
 /*
 * Copyright (C) 2018 Istituto Italiano di Tecnologia
 * Authors: davide.tome@iit.it
 * CopyPolicy: Released under the terms of the LGPLv2.1 or later, see LGPL.TXT
 */
-->
<iCubProductionTestSuite>

	<startup  type="batch" batchDir="tools\boards\icub-firmware-build" batchFile="setup-fw-repo.bat" noFail="true" /> 
	<startup  type="batch" batchDir="tools\boards\icub-firmware-build" batchFile="udpdate-fw-repo.bat" errorMessage="Impossibile aggiornare la repository del firmware, assicurarsi di eseguire IPTS come amministratore o controllare la connessione internet" />


  <!-- **************************************************************************************************
  
		TESTPLAN FOR MTB4 rev B and C
  
       **************************************************************************************************-->
	   
  <testplan id="0" board="MTB4" iitcode="12008.B" reportsDir="mtb4" rev="5">

    <interfaces>
      <interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
    </interfaces>

    <test id="1" name="Test Assenza corto 5V-GND" stopOnFail="true">
      <operation type="okDialog" text="Verificare che i pin 1 e 4 del connettore J1 non siano in corto." image="img/mtb4/MTB4_short.jpg" />
      <operation type="passFailDialog" text="I pin NON SONO in corto?" />
    </test>

	  <test id="2" name="Flash Firmware di test" stopOnFail="true">
		  <operation type="okDialog" text="Collegamenti setup:

1. Connettere l' ESD CAN-USB (2) ed il ST-Link (3) alle USB del PC (1)

2. Connettere l' ESD CAN-USB (2) alla MTB4 (MTB4-J1) 

3. Connettere la “ADC_MTB_LED” (6) alla MTB4 (MTB4-J3) 

4. Premere Invio a programmazione terminata
					
UTILIZZARE SEMPRE IL TOOL PER ESTRARRE I CONNETTORI MOLEX (5)"
					   
					 image="img/mtb4/MTB4_setup.jpg" />
		  <operation type="batch" batchDir="tools\boards\mtb4\flash" batchFile="mtb4_test.bat" />
	  </test>

    <test id="3" name="Test comunicazione CAN" stopOnFail="true">
      <operation type="send" interface="CAN" command="06"/>
      <operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
    </test>
    
    <test id="4" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
      <operation type="send" interface="CAN" command="00" />
      <operation type="receivePassFail" interface="CAN" valPass="0x03 0x00" logMess="1" />
    </test>

    <test id="5" name="Test Led OFF">
      <operation type="send" interface="CAN" command="01" />
      <operation type="yesNoDialog" text="I led rosso e blu sono spenti?" image="img/mtb4/MTB4_ledoff.jpg" />
    </test>

    <test id="6" name="Test Led ON">
      <operation type="send" interface="CAN" command="02" />
      <operation type="yesNoDialog" text="I led rosso e blu sono accesi?" image="img/mtb4/MTB4_ledon.jpg" />
    </test>

    <test id="7" name="Test Temperatura">
      <operation type="inputValue" text="Inserire il valore della temperatura ambiente" var="tempIn" varType="num" />
      <operation type="send" interface="CAN" command="03" appendVar="tempIn" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>

    <test id="8" name="Test GPIO">
      <operation type="okDialog" text="Verificare che i sei led della scheda ADC_MTB4_LED_12660_A si accendano in sequenza..." image="img/mtb4/MTB4_gpio.jpg" />
      <operation type="send" interface="CAN" command="05" />
      <operation type="wait" value="4000" />
      <operation type="passFailDialog" text="i 6 led si sono accesi in sequenza?" />
    </test>

    <test id="9" name="Test IMU">
      <operation type="send" interface="CAN" command="04" />
      <operation type="receivePassFail" interface="CAN" valPass="0xA0"  logMess="1" />
    </test>

    <test id="10" name="Test secondo CAN">
      <operation type="okDialog" text="Connettere il cavo CAN al secondo connettore (J2) e premere ok" image="img/mtb4/MTB4_can.jpg" />
      <operation type="wait" value="1000" />
      <operation type="send" interface="CAN" command="06" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" />
    </test>

    <test id="11" name="Flash Bootloader/Applicativo">
      <operation type="batch" batchDir="tools\boards\mtb4\flash" batchFile="mtb4_prod.bat" />
    </test>
  </testplan>


	<testplan id="1" board="MTB4C" iitcode="12008.C" reportsDir="mtb4c" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
		</interfaces>

		
		<test id="1" name="Test Assenza corto 5V-GND" stopOnFail="true">
			<operation type="okDialog" text="Verificare che i pin 1 e 4 del connettore J1 non siano in corto." image="img/mtb4/MTB4_short.jpg" />
			<operation type="passFailDialog" text="I pin NON SONO in corto?" />
		</test>

		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="okDialog" text="Collegamenti setup:

1. Connettere l' ESD CAN-USB (2) ed il ST-Link (3) alle USB del PC (1)

2. Connettere l' ESD CAN-USB (2) alla MTB4 (MTB4-J1) 

3. Connettere la “ADC_MTB_LED” (6) alla MTB4 (MTB4-J3) 

4. Premere Invio a programmazione terminata
					
UTILIZZARE SEMPRE IL TOOL PER ESTRARRE I CONNETTORI MOLEX (5)"
					   
					   image="img/mtb4/MTB4_setup.jpg" />
			<operation type="batch" batchDir="tools\boards\mtb4\flash" batchFile="mtb4c_test.bat" />
		</test>

		<test id="3" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="send" interface="CAN" command="06"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="4" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
			<operation type="send" interface="CAN" command="00" />
			<operation type="receivePassFail" interface="CAN" valPass="0x01 0x00" logMess="1" />
		</test>

		<test id="5" name="Test Led OFF">
			<operation type="send" interface="CAN" command="01" />
			<operation type="yesNoDialog" text="I led rosso e blu sono spenti?" image="img/mtb4/MTB4_ledoff.jpg" />
		</test>

		<test id="6" name="Test Led ON">
			<operation type="send" interface="CAN" command="02" />
			<operation type="yesNoDialog" text="I led rosso e blu sono accesi?" image="img/mtb4/MTB4_ledon.jpg" />
		</test>

		<test id="7" name="Test Temperatura">
			<operation type="inputValue" text="Inserire il valore della temperatura ambiente" var="tempIn" varType="num" />
			<operation type="send" interface="CAN" command="03" appendVar="tempIn" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="8" name="Test GPIO">
			<operation type="okDialog" text="Verificare che i sei led della scheda ADC_MTB4_LED_12660_A si accendano in sequenza..." image="img/mtb4/MTB4_gpio.jpg" />
			<operation type="send" interface="CAN" command="05" />
			<operation type="wait" value="4000" />
			<operation type="passFailDialog" text="i 6 led si sono accesi in sequenza?" />
		</test>

		<test id="9" name="Test IMU">
			<operation type="send" interface="CAN" command="04" />
			<operation type="receivePassFail" interface="CAN" valPass="0xA0"  logMess="1" />
		</test>

		<test id="10" name="Test secondo CAN">
			<operation type="okDialog" text="Connettere il cavo CAN al secondo connettore (J2) e premere ok" image="img/mtb4/MTB4_can.jpg" />
			<operation type="wait" value="1000" />
			<operation type="send" interface="CAN" command="06" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" />
		</test>

		<test id="11" name="Flash Bootloader/Applicativo">
			<operation type="batch" batchDir="tools\boards\mtb4\flash" batchFile="mtb4c_prod.bat" />
		</test>
	</testplan>

  <!-- **************************************************************************************************
  
		TESTPLAN FOR STRAIN2 rev B and C
  
       **************************************************************************************************-->

  <testplan id="2" board="STRAIN2" iitcode="11996.B" reportsDir="strain2" rev="5">

    <interfaces>
      <interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
    </interfaces>

    <test id="1" name="Test Assenza corto VIN-GND" stopOnFail="true">
      <operation type="okDialog" text="Verificare con il multimetro che i pad 1 e 4 NON siano in corto." image="img/strain2/strain2_short.jpg" />
      <operation type="passFailDialog" text="I pin NON SONO in corto?" />
    </test>

	  <test id="2" name="Flash Firmware di test" stopOnFail="true">
		  <operation type="okDialog" text="Collocare la scheda (DUT) nel jig come in figura
										Assicurarsi che gli switch siano nella corretta posizione." image="img/strain2/strain2_setup1.jpg" />
		  <operation type="okDialog" text="Collegare il setup di test come in figura

1. Connettere l'ESD CAN-USB (2) e il programmatore ST-LINK (3) alle usb del PC

2. Connettere l'ESD CAN-USB (2) an connettore J3 del jig (4)

3. Connettere il programmatore ST-LINK (3) al connettore J2 del jig (4) 

4. Premere Invio a programmazione terminata"

					 image="img/strain2/strain2_setup2.jpg" />
		  <operation type="batch" batchDir="tools\boards\strain2\flash" batchFile="strain2_test.bat" />
	  </test>

    <test id="3" name="Test comunicazione CAN" stopOnFail="true">
      <operation type="send" interface="CAN" command="06"/>
      <operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
    </test>
        
    <test id="4" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
      <operation type="send" interface="CAN" command="00" />
      <operation type="receivePassFail" interface="CAN" valPass="0x03 0x00" logMess="1" />
    </test>

    <test id="5" name="Test Led OFF">
      <operation type="send" interface="CAN" command="01" />
      <operation type="yesNoDialog" text="Il led blu é spento?" image="img/strain2/strain2_ledOFF.jpg" />
    </test>

    <test id="6" name="Test Led ON">
      <operation type="send" interface="CAN" command="02" />
      <operation type="yesNoDialog" text="Il led blu é acceso?" image="img/strain2/strain2_ledON.jpg" />
    </test>

    <test id="7" name="Test sensori di temperatura (top+bottom)">
      <operation type="inputValue" text="Inserire il valore della temperatura ambiente" var="tempIn" varType="num" />
      <operation type="send" interface="CAN" command="03" appendVar="tempIn" />
      <operation type="wait" value="500" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1"/>
    </test>

	  <test id="8" name="Test IMU">
		  <operation type="wait" value="500" />
		  <operation type="send" interface="CAN" command="04" />
		  <operation type="receivePassFail" interface="CAN" valPass="0xA0"  logMess="1" />
	  </test>

	  <test id="9" name="Test dei 6 canali analogici">
		  <operation type="send" interface="CAN" command="05"/>
		  <operation type="wait" value="500" />
		  <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="3" />
	  </test>


	  <test id="10" name="Flash Bootloader/Applicativo">
      <operation type="batch" batchDir="tools\boards\strain2\flash" batchFile="strain2_prod.bat" />
    </test>
  </testplan>


	<testplan id="3" board="STRAIN2C" iitcode="11996.C" reportsDir="strain2c" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
		</interfaces>

		<test id="1" name="Test Assenza corto VIN-GND" stopOnFail="true">
			<operation type="okDialog" text="Verificare con il multimetro che i pad 1 e 4 NON siano in corto." image="img/strain2/strain2_short.jpg" />
			<operation type="passFailDialog" text="I pin NON SONO in corto?" />
		</test>

		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="okDialog" text="Collocare la scheda (DUT) nel jig come in figura
										Assicurarsi che gli switch siano nella corretta posizione." image="img/strain2/strain2_setup1.jpg" />
			<operation type="okDialog" text="Collegare il setup di test come in figura

1. Connettere l'ESD CAN-USB (2) e il programmatore ST-LINK (3) alle usb del PC

2. Connettere l'ESD CAN-USB (2) an connettore J3 del jig (4)

3. Connettere il programmatore ST-LINK (3) al connettore J2 del jig (4) 

4. Premere Invio a programmazione terminata"

					   image="img/strain2/strain2_setup2.jpg" />
			<operation type="batch" batchDir="tools\boards\strain2\flash" batchFile="strain2c_test.bat" />
		</test>

		<test id="3" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="send" interface="CAN" command="06"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="4" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
			<operation type="send" interface="CAN" command="00" />
			<operation type="receivePassFail" interface="CAN" valPass="0x01 0x00" logMess="1" />
		</test>

		<test id="5" name="Test Led OFF">
			<operation type="send" interface="CAN" command="01" />
			<operation type="yesNoDialog" text="Il led blu é spento?" image="img/strain2/strain2_ledOFF.jpg" />
		</test>

		<test id="6" name="Test Led ON">
			<operation type="send" interface="CAN" command="02" />
			<operation type="yesNoDialog" text="Il led blu é acceso?" image="img/strain2/strain2_ledON.jpg" />
		</test>

		<test id="7" name="Test sensori di temperatura (top+bottom)">
			<operation type="inputValue" text="Inserire il valore della temperatura ambiente" var="tempIn" varType="num" />
			<operation type="send" interface="CAN" command="03" appendVar="tempIn" />
			<operation type="wait" value="500" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1"/>
		</test>

		<test id="8" name="Test IMU">
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="04" />
			<operation type="receivePassFail" interface="CAN" valPass="0xA0"  logMess="1" />
		</test>
		
		<test id="9" name="Test dei 6 canali analogici">
			<operation type="send" interface="CAN" command="05"/>
			<operation type="wait" value="500" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="3" />
		</test>
		
		<test id="10" name="Flash Bootloader/Applicativo">
			<operation type="batch" batchDir="tools\boards\strain2\flash" batchFile="strain2c_prod.bat" />
		</test> 
	</testplan>


    <!-- **************************************************************************************************
  
		TESTPLAN FOR MC4-PLUS
  
       **************************************************************************************************-->

  <testplan id="4" board="MC4-PLUS" iitcode="5443.D" reportsDir="mc4plus" rev="1">

    <interfaces>
      <interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
    </interfaces>
	
	<test id="1" name="Test Assorbimento" stopOnFail="true">
	  <operation type="okDialog" text="Collegare la scheda al cavo di alimentazione del setup ed al programmatore ST-LINK come in figura. Impostare l'alimentatore a 24Vdc @0.3A ed alimentare la scheda" image="img/mc4plus/connections1.jpg" />
      <operation type="passFailDialog" text="L'assorbimento é inferiore a 80 mA?" />
    </test>
	
	<test id="2" name="Flash Firmware di test" stopOnFail="true">
      <operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_test.bat" />
    </test>
	
	<test id="3" name="Test Fimware Running" stopOnFail="true">
	  <operation type="wait" value="4000" />
      <operation type="yesNoDialog" text="Scollegare il programmatore ST-LINK 2 e capovolgere la scheda. Il led VERDE DL3 lampeggia?" image="img/mc4plus/fw-running.gif" />
    </test>
	
		
	<test id="4" name="Test comunicazione CAN" stopOnFail="true">
  	  <operation type="okDialog" text="Collegare il cavo CAN dell' ESD CAN/USB al connettore P9 della mc4plus lasciando vuoti i pin laterali" image="img/mc4plus/can-connect.jpg" />
  	  <operation type="wait" value="1000" />
      <operation type="send" interface="CAN" command="23"/>
      <operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
    </test>
	
	<test id="5" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
      <operation type="send" interface="CAN" command="0" />
      <operation type="receivePassFail" interface="CAN" valPass="0x02 0x00" logMess="1" />
    </test>
	
	<test id="6" name="Test Leds">
	  <operation type="okDialog" text="Premere OK e verificare che i led DL1, DL2, DL3, DL6 (green, yellow, green, orange) lampeggino per 2 volte in sequenza come da immagine, e che i led DL4, DL5 (blue, orange) siano accesi." image="img/mc4plus/check-leds.gif" />
      <operation type="send" interface="CAN" command="3" />
      <operation type="wait" value="6000" />
      <operation type="passFailDialog" text="i led hanno lampeggiato correttamente?" />
    </test>

    <test id="7" name="Connessioni Setup">
	  <operation type="okDialog" text="Disalimentare la scheda, posizionarla sul setup e collegare tutti i cavi ai risppettivi connettori come in figura. Alimentare a 24Vdc @3A; quindi premere OK." image="img/mc4plus/connections2.jpg" />
	  <operation type="wait" value="2000" />
   </test>
	
	<test id="8" name="Test TVIN">
      <operation type="send" interface="CAN" command="4" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="9" name="Test TVAUX">
      <operation type="send" interface="CAN" command="5" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="10" name="Test Analog Input AN1">
      <operation type="send" interface="CAN" command="6" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="11" name="Test Analog Input AN2">
      <operation type="send" interface="CAN" command="7" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="12" name="Test Analog Input AN3">
      <operation type="send" interface="CAN" command="8" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="13" name="Test Analog Input AN4">
      <operation type="send" interface="CAN" command="9" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="14" name="Test Encoder Reading 1 (P2)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U2 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u2.gif" />
      <operation type="send" interface="CAN" command="13" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="15" name="Test Encoder Reading 2 (P3)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U1 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u1.gif" />
      <operation type="send" interface="CAN" command="14" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="16" name="Test Encoder Reading 3 (P4)">
      <operation type="okDialog" text="Premere OK quindi premere e rilasciare U3 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u3.gif" />     
	  <operation type="send" interface="CAN" command="15" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="17" name="Test Encoder Reading 4 (P5)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U4 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u4.gif" />
      <operation type="send" interface="CAN" command="16" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="18" name="Test PWM 1 (P2)">
      <operation type="send" interface="CAN" command="17" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="19" name="Test PWM 2 (P3)">
      <operation type="send" interface="CAN" command="18" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="20" name="Test PWM 3 (P4)">
      <operation type="send" interface="CAN" command="19" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="21" name="Test PWM 4 (P5)">
      <operation type="send" interface="CAN" command="20" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="22" name="Test EEprom">
      <operation type="send" interface="CAN" command="10" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="23" name="Test Micrel">
      <operation type="send" interface="CAN" command="11" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="24" name="Test SPI">
      <operation type="send" interface="CAN" command="12" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="25" name="Test Fault L">
	  <operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-1.jpg" />
      <operation type="send" interface="CAN" command="21" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="26" name="Test Fault H">
	  <operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-2.jpg" />
      <operation type="send" interface="CAN" command="22" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
    <test id="27" name="Flash Bootloader/Applicativo">
	  <operation type="okDialog" text="Disalimentare la scheda e collegare il programmatore ST-LINK 2 al connettore P1 della scheda; quindi alimentare nuovamente e premere OK. Premere invio a programmazione terminata" image="img/mc4plus/flashapp.jpg" />
      <operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_prod.bat" />
    </test>
	
	<test id="28" name="Test interefaccia ETH P12">
  	  <operation type="okDialog" text="Connettere il cavo Ethernet del setup 'ETH' al connettore 'P12' della scheda" image="img/mc4plus/eth-1.jpg" />
	  <operation type="wait" value="2500" />
      <operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
    </test>
	
	<test id="29" name="Test interefaccia ETH P13">
	  <operation type="okDialog" text="Connettere il cavo Ethernet del setup 'ETH' al connettore 'P13' della scheda" image="img/mc4plus/eth-2.jpg" />
	  <operation type="wait" value="2500" />
      <operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
    </test>
	
  </testplan>

  <testplan id="5" board="MC4-PLUS" iitcode="5443.E" reportsDir="mc4plus" rev="1">

    <interfaces>
      <interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
    </interfaces>
	
	<test id="1" name="Test Assorbimento" stopOnFail="true">
	  <operation type="okDialog" text="Collegare la scheda al cavo di alimentazione del setup ed al programmatore ST-LINK come in figura. Impostare l'alimentatore a 24Vdc @0.3A ed alimentare la scheda" image="img/mc4plus/connections1.jpg" />
      <operation type="passFailDialog" text="L'assorbimento é inferiore a 80 mA?" />
    </test>
	
	<test id="2" name="Flash Firmware di test" stopOnFail="true">
      <operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_test.bat" />
    </test>
	
	<test id="3" name="Test Fimware Running" stopOnFail="true">
	  <operation type="wait" value="4000" />
      <operation type="yesNoDialog" text="Scollegare il programmatore ST-LINK 2 e capovolgere la scheda. Il led VERDE DL3 lampeggia?" image="img/mc4plus/fw-running.gif" />
    </test>
	
		
	<test id="4" name="Test comunicazione CAN" stopOnFail="true">
  	  <operation type="okDialog" text="Collegare il cavo CAN dell' ESD CAN/USB al connettore P9 della mc4plus lasciando vuoti i pin laterali" image="img/mc4plus/can-connect.jpg" />
  	  <operation type="wait" value="1000" />
      <operation type="send" interface="CAN" command="23"/>
      <operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
    </test>
	
	<test id="5" name="Verifica Revisione Firmmware di Test">
      <operation type="send" interface="CAN" command="0" />
      <operation type="receivePassFail" interface="CAN" valPass="0x02 0x00" logMess="1" />
    </test>
	
	<test id="6" name="Test Leds">
	  <operation type="okDialog" text="Premere OK e verificare che i led DL1, DL2, DL3, DL6 (green, yellow, green, orange) lampeggino per 2 volte in sequenza come da immagine, e che i led DL4, DL5 (blue, orange) siano accesi." image="img/mc4plus/check-leds.gif" />
      <operation type="send" interface="CAN" command="3" />
      <operation type="wait" value="6000" />
      <operation type="passFailDialog" text="i led hanno lampeggiato correttamente?" />
    </test>

    <test id="7" name="Connessioni Setup">
	  <operation type="okDialog" text="Disalimentare la scheda, posizionarla sul setup e collegare tutti i cavi ai risppettivi connettori come in figura. Alimentare a 24Vdc @3A; quindi premere OK." image="img/mc4plus/connections2.jpg" />
	  <operation type="wait" value="2000" />
   </test>
	
	<test id="8" name="Test TVIN">
      <operation type="send" interface="CAN" command="4" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="9" name="Test TVAUX">
      <operation type="send" interface="CAN" command="5" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="10" name="Test Analog Input AN1">
      <operation type="send" interface="CAN" command="6" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="11" name="Test Analog Input AN2">
      <operation type="send" interface="CAN" command="7" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="12" name="Test Analog Input AN3">
      <operation type="send" interface="CAN" command="8" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="13" name="Test Analog Input AN4">
      <operation type="send" interface="CAN" command="9" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="14" name="Test Encoder Reading 1 (P2)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U2 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u2.gif" />
      <operation type="send" interface="CAN" command="13" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="15" name="Test Encoder Reading 2 (P3)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U1 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u1.gif" />
      <operation type="send" interface="CAN" command="14" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="16" name="Test Encoder Reading 3 (P4)">
      <operation type="okDialog" text="Premere OK quindi premere e rilasciare U3 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u3.gif" />     
	  <operation type="send" interface="CAN" command="15" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="17" name="Test Encoder Reading 4 (P5)">
	  <operation type="okDialog" text="Premere OK quindi premere e rilasciare U4 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u4.gif" />
      <operation type="send" interface="CAN" command="16" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="18" name="Test PWM 1 (P2)">
      <operation type="send" interface="CAN" command="17" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="19" name="Test PWM 2 (P3)">
      <operation type="send" interface="CAN" command="18" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="20" name="Test PWM 3 (P4)">
      <operation type="send" interface="CAN" command="19" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="21" name="Test PWM 4 (P5)">
      <operation type="send" interface="CAN" command="20" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="22" name="Test EEprom">
      <operation type="send" interface="CAN" command="10" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="23" name="Test Micrel">
      <operation type="send" interface="CAN" command="11" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="24" name="Test SPI">
      <operation type="send" interface="CAN" command="12" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="25" name="Test Fault L">
	  <operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-1.jpg" />
      <operation type="send" interface="CAN" command="21" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
	<test id="26" name="Test Fault H">
	  <operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-2.jpg" />
      <operation type="send" interface="CAN" command="22" />
      <operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
    </test>
	
    <test id="27" name="Flash Bootloader/Applicativo">
	  <operation type="okDialog" text="Disalimentare la scheda e collegare il programmatore ST-LINK 2 al connettore P1 della scheda; quindi alimentare nuovamente e premere OK" image="img/mc4plus/flashapp.jpg" />
      <operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_prod.bat" />
    </test>
	
	<test id="28" name="Test interefaccia ETH P12">
  	  <operation type="okDialog" text="Connettere il cavo Ethernet del setup 'ETH' al connettore 'P12' della scheda" image="img/mc4plus/eth-1.jpg" />
	  <operation type="wait" value="2500" />
      <operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
    </test>
	
	<test id="29" name="Test interefaccia ETH P13">
	  <operation type="okDialog" text="Connettere il cavo Ethernet del setup 'ETH' al connettore 'P13' della scheda" image="img/mc4plus/eth-2.jpg" />
	  <operation type="wait" value="2500" />
      <operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
    </test>
	
  </testplan>

	<testplan id="5" board="MC4-PLUS C-SHAPE" iitcode="10004.B" reportsDir="mc4plus-c-shape" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
		</interfaces>

		<test id="1" name="Test Assorbimento" stopOnFail="true">
			<operation type="okDialog" text="Collegare la scheda al setup come in figura.

1. Connettere l'ESD CAN-USB (1) e il programmatore ST-LINK (2) alle usb del PC
2. Connettere l'ESD CAN-USB (1) al connettore P9 della scheda lasciando i 2 pin laterali vuoti 
3. Connettere il cavo PWR del jig al connettore P7 della scheda
4. Connettere il cavo FLT del jig al connettore P6 della scheda
5. Connettere il cavo ETH del jig al connettore P12 della scheda
6. Connettere il cavo P2 del jig al connettore P2 della scheda
7. Connettere il cavo P3 del jig al connettore P3 della scheda
8. Connettere il cavo P4 del jig al connettore P4 della scheda
9. Connettere il cavo P5 del jig al connettore P5 della scheda
10. Connettere il cavo SPI1 del jig al connettore P10 della scheda
11. Connettere il cavo SPI2 del jig al connettore P11 della scheda
12. Connettere il programmatore ST-LINK (2) al connettore P1 della scheda
13. Connettere il cavo ETH dal PC al connettore ETH_PORT1 del jig
				   
Impostare l'alimentatore a 24Vdc @0.3A ed alimentare la scheda" image="img\mc4plus-cshape\mc4plus-cshape.jpg" />
			<operation type="passFailDialog" text="L'assorbimento é inferiore a 100 mA?" />

		</test>

		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="message" text="Disalimentare, impostare l'alimentatore a 24Vdc @3A e alimentare la scheda" />
			<operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_test.bat" />
		</test>

		<test id="3" name="Test Fimware Running" stopOnFail="true">
			<operation type="wait" value="4000" />
			<operation type="yesNoDialog" text="Il led VERDE DL3 lampeggia?" image="img/mc4plus-cshape/mc4plus-cshape-app-run.gif" />
		</test>


		<test id="4" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="send" interface="CAN" command="23"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="5" name="Verifica Revisione Firmmware di Test">
			<operation type="send" interface="CAN" command="0" />
			<operation type="receivePassFail" interface="CAN" valPass="0x02 0x00" logMess="1" />
		</test>

		<test id="6" name="Test Leds">
			<operation type="okDialog" text="Premere OK e verificare che i led DL1, DL2, DL3, DL6 (green, yellow, green, orange) lampeggino come da immagine, e che i led DL4, DL5 (blue, orange) siano accesi." image="img/mc4plus-cshape/mc4plus-cshape-test-led.gif" />
			<operation type="send" interface="CAN" command="3" />
			<operation type="wait" value="6000" />
			<operation type="passFailDialog" text="i led hanno lampeggiato correttamente?" />
		</test>

		<test id="7" name="Test TVIN">
			<operation type="send" interface="CAN" command="4" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="8" name="Test TVAUX">
			<operation type="send" interface="CAN" command="5" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="9" name="Test Analog Input AN1">
			<operation type="send" interface="CAN" command="6" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="10" name="Test Analog Input AN2">
			<operation type="send" interface="CAN" command="7" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="11" name="Test Analog Input AN3">
			<operation type="send" interface="CAN" command="8" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="12" name="Test Analog Input AN4">
			<operation type="send" interface="CAN" command="9" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="13" name="Test Encoder Reading 1 (P2)">
			<operation type="okDialog" text="Premere OK quindi premere e rilasciare U2 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u2.gif" />
			<operation type="send" interface="CAN" command="13" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="14" name="Test Encoder Reading 2 (P3)">
			<operation type="okDialog" text="Premere OK quindi premere e rilasciare U1 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u1.gif" />
			<operation type="send" interface="CAN" command="14" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="15" name="Test Encoder Reading 3 (P4)">
			<operation type="okDialog" text="Premere OK quindi premere e rilasciare U3 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u3.gif" />
			<operation type="send" interface="CAN" command="15" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="16" name="Test Encoder Reading 4 (P5)">
			<operation type="okDialog" text="Premere OK quindi premere e rilasciare U4 sul setup di test, infine ruotarlo di almeno 90 gradi" image="img/mc4plus/encoder-u4.gif" />
			<operation type="send" interface="CAN" command="16" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="17" name="Test PWM 1 (P2)">
			<operation type="send" interface="CAN" command="17" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="18" name="Test PWM 2 (P3)">
			<operation type="send" interface="CAN" command="18" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="19" name="Test PWM 3 (P4)">
			<operation type="send" interface="CAN" command="19" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="20" name="Test PWM 4 (P5)">
			<operation type="send" interface="CAN" command="20" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="21" name="Test EEprom">
			<operation type="send" interface="CAN" command="10" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="22" name="Test Micrel">
			<operation type="send" interface="CAN" command="11" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="23" name="Test SPI">
			<operation type="send" interface="CAN" command="12" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="24" name="Test Fault L">
			<operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-1.jpg" />
			<operation type="send" interface="CAN" command="21" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="25" name="Test Fault H">
			<operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/mc4plus/fault-2.jpg" />
			<operation type="send" interface="CAN" command="22" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA" logMess="1" />
		</test>

		<test id="26" name="Flash Bootloader/Applicativo">
			<operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_prod.bat" />
            <operation type="batch" batchDir="tools\boards\mc4plus\flash" batchFile="mc4plus_reset.bat" />
		</test>

		<test id="27" name="Test interefaccia ETH P12">
			<operation type="wait" value="5000" />
			<operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
		</test>

		<test id="28" name="Test interefaccia ETH P13">
			<operation type="okDialog" text="Connettere il cavo Ethernet del setup 'ETH' al connettore 'P13' della scheda" image="img/mc4plus-cshape/eth-2.jpg" />
			<operation type="wait" value="1000" />
			<operation type="batch" batchDir="tools\boards\mc4plus\eth" batchFile="test_eth.bat" />
		</test>

	</testplan>
  
	<!-- **************************************************************************************************
  
		TESTPLAN FOR RFE 
  
       **************************************************************************************************-->

	<testplan id="6" board="RFE_MASTER_MPCA" iitcode="12024.C" reportsDir="rfe" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
			<interface name="SERIAL" netPort="COM4" bitrate="9600" />
		</interfaces>

		<test id="1" name="Connessioni Setup">
			<operation type="okDialog" text="Collegare il setup di test come in figura

1. Impostare l'alimentatore a 12V @0.8A

2. Connettere il cavo di alimentazione (1) al connettore J5 della RFE (2)

3. Connettere il programmatore ST-LINK (3) al connettore J8 della RFE (4) 

4. Connettere l'interfaccia USB/CAN (5) al connettore J4 della RFE (6)

5. Connettere il cavo USBC al connettore J9 della RFE (7)

6. Premere Invio a programmazione terminata"
					   image="img/rfe/rfe-setup.jpg" />
			<operation type="wait" value="2000" />
		</test>
		
		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="batch" batchDir="tools\boards\rfe\flash" batchFile="rfe_test.bat" />
		</test>

		<test id="3" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="send" interface="CAN" command="0"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="4" name="Test comunicazione Seriale" stopOnFail="false">
			<operation type="send" interface="SERIAL" command="test"/>
			<operation type="wait" value="1000" />
			<operation type="receivePassFail" interface="SERIAL" valPass="  OK"/>
		</test>

		<test id="5" name="Test Led Blue OFF">
			<operation type="send" interface="CAN" command="02" />
			<operation type="yesNoDialog" text="Il led blu é spento?" image="img/rfe/rfe-ledOFF.jpg" />
		</test>

		<test id="6" name="Test Led Blue ON">
			<operation type="send" interface="CAN" command="03" />
			<operation type="yesNoDialog" text="Il led blu é acceso?" image="img/rfe/rfe-ledON.jpg" />
		</test>

		<test id="7" name="Test Connector J10 (i2c1)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J10 come in figura" image="img/rfe/rfe-j10.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="08" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="8" name="Test Connector J11 (i2c2)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J11 come in figura" image="img/rfe/rfe-j11.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="09" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="9" name="Test Connector J12 (i2c3)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J12 come in figura" image="img/rfe/rfe-j12.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="10" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="10" name="Test Connector J13 (i2c4)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J13 come in figura" image="img/rfe/rfe-j13.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="11" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="11" name="Test Connector J1 (spi1)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J1 come in figura" image="img/rfe/rfe-j1.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="12" />
			<operation type="passFailDialog" text="I led sulla scheda esterna sono accesi?" />
		</test>

		<test id="12" name="Test IMU BOSCH">
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="05" />
			<operation type="receivePassFail" interface="CAN" valPass="0xA0"  logMess="1" />
		</test>

		<test id="13" name="Test IMU MPU-9250">
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="06" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="14" name="Test Connector J2 (servo)">
			<operation type="okDialog" text="Collegare apposito connettore esterno al connettore J2 come in figura" image="img/rfe/rfe-j2.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="07" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>

		<test id="15" name="Test J5 (12V)">
			<operation type="okDialog" text="Accendere alimentatore esterno 12V " image="img/rfe/rfe-j5.jpg"/>
			<operation type="send" interface="CAN" command="04" />
			<operation type="wait" value="500" />			
			<operation type="passFailDialog" text="Scollegare il cavo USB, Il led Blue é sempre acceso?"  image="img/rfe/rfe-j5_2jpg"/>
		</test>
		
		<test id="16" name="Flash Bootloader/Applicativo">
			<operation type="batch" batchDir="tools\boards\rfe\flash" batchFile="rfe_prod.bat" />
		</test>
		
	</testplan>
<!-- **************************************************************************************************
  
		TESTPLAN FOR FAP5 
  
       **************************************************************************************************-->

	<testplan id="7" board="FAP5" iitcode="15423.A" reportsDir="fap5" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
		</interfaces>

		<test id="1" name="Connessioni Setup">
			<operation type="okDialog" text="Collegare il setup di test come in figura

1. Connect the ST-LINK's debugger (1) to the J8 RFE's connector (2) an to the PC
2. Connect the USB/CAN's interface (3) to the J4 RFE's connector (4) and to the PC
3. Connect the FAP5 (5) to be tested to J10 rfe connector (6)"

					   image="img/fap5/fap5-setup.jpg" />
			<operation type="wait" value="2000" />
		</test>
		
		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="batch" batchDir="tools\boards\rfe\flash" batchFile="rfe_test.bat" />
		</test>

		<test id="3" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="send" interface="CAN" command="0"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="4" name="Test FAP J10 (i2c1)">
			<operation type="okDialog" text="Collegare la FAP5 da testare al connettore J10 come in figura" image="img/rfe/rfe-j10.jpg" />
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="08" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"  logMess="1" />
		</test>
				
	</testplan>

	<!-- **************************************************************************************************
  
		TESTPLAN FOR AMC-BLDC 
  
       **************************************************************************************************-->

	<testplan id="8" board="AMC-BLDC" iitcode="14962.D" reportsDir="amc-bldc" rev="1">

		<interfaces>
			<interface name="CAN" netPort="0" bitrate="1000" messageID="0x551" />
		</interfaces>

		<test id="1" name="Connessioni Setup">
			<operation type="okDialog" text="Collegare il setup di test come in figura

1. Connect the Power Cable (1) to the J7 AMC-BLDC's connector (2)
2. Connect the USB/CAN's interface (3) to the J5 AMC-BLDC's connector (4) and to the PC
3. Connect the ST-LINK programmer (5) to the J3 DGBADP 's connector (6)
4. Connect the DGBADP flying connector (7) to the J1 AMC-BLDC's connector
5. Connect the Hall/ABZ enconder jig cable (A) to the J3 AMC-BLDC's connector
6. Connect the I2C/Break jig cable (B) to the J2 AMC-BLDC's connector
7. Swotch ON the poer supply
8. Hit ENTER at the end of programming"

					   image="img/amc-bldc/amc-bldc_setup.jpg" />
			<operation type="wait" value="2000" />
		</test>

		<test id="2" name="Flash Firmware di test" stopOnFail="true">
			<operation type="batch" batchDir="tools\boards\amc-bldc\flash" batchFile="amc-bldc_test.bat" />
		</test>

		<test id="3" name="Test comunicazione CAN" stopOnFail="true">
			<operation type="wait" value="500" />
			<operation type="send" interface="CAN" command="0"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="4" name="Verifica Revisione Firmmware di Test" stopOnFail="true">
			<operation type="send" interface="CAN" command="1" />
			<operation type="receivePassFail" interface="CAN" valPass="0x01 0x00" logMess="1" />
		</test>

		<test id="5" name="Verifica Device ID microcontrollore">
			<operation type="send" interface="CAN" command="4" />
			<operation type="receivePassFail" interface="CAN" valPass="0x20 0x03 0x04 0x69" logMess="1" />
		</test>

		<test id="6" name="Test Leds OFF">
			<operation type="send" interface="CAN" command="2" />
			<operation type="yesNoDialog" text="I led rosso e vedre sono spenti?" image="img/amc-bldc/amc-bldc_LED_OFF.jpg" />
		</test>

		<test id="7" name="Test Leds ON">
			<operation type="send" interface="CAN" command="3" />
			<operation type="yesNoDialog" text="I led rosso e vedre sono accesi?" image="img/amc-bldc/amc-bldc_LED_ON.jpg" />
		</test>

		<test id="8" name="Test VIN" stopOnFail="true">
			<operation type="send" interface="CAN" command="5"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="9" name="Test CIN">
			<operation type="send" interface="CAN" command="6"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="10" name="Test VAUXOK">
			<operation type="send" interface="CAN" command="7"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="11" name="Test VCCOK">
			<operation type="send" interface="CAN" command="8"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="12" name="Test FAULT OFF">
			<operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/amc-bldc/amc-bldc_FAULT_OFF.jpg" />
			<operation type="send" interface="CAN" command="9" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="13" name="Test FAULT ON">
			<operation type="okDialog" text="Posizionare lo switch sul setup come in figura" image="img/amc-bldc/amc-bldc_FAULT_ON.jpg" />
			<operation type="send" interface="CAN" command="10" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="14" name="Test I2C">
			<operation type="send" interface="CAN" command="11"/>
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="15" name="Test Hall sensors">
			<operation type="okDialog" text="Premere OK quindi ruota il rotore a mano come in figura" image="img/amc-bldc/amc-bldc_encoders.gif" />
			<operation type="send" interface="CAN" command="12" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>

		<test id="16" name="Test Incremental Encoder">
			<operation type="okDialog" text="Premere OK quindi ruota il rotore a mano come in figura" image="img/amc-bldc/amc-bldc_encoders.gif" />
			<operation type="send" interface="CAN" command="13" />
			<operation type="receivePassFail" interface="CAN" valPass="0xAA"/>
		</test>
		
		<test id="17" name="Flash Bootloader/Applicativo">
			<operation type="batch" batchDir="tools\boards\amc-bldc\flash" batchFile="amc-bldc_prod.bat" />
		</test>
	    
	</testplan>
	
	
	
	
	
    <!-- **************************************************************************************************
  
		TESTPLAN FOR DC MOTORS
  
       **************************************************************************************************-->
	   
   <testplan id="9" board="DC MOTORS" iitcode="2694" reportsDir="dcMotors" rev="1">

    <test id="1" name="Connessioni Setup">
	  <operation type="okDialog" text="Preparazione setup di test..." image="img/dcMotors/setup.jpg" />
      <operation type="okDialog" text="Collegare ed impostare l'alimentatore come in figura" image="img/dcMotors/pws.jpg" />
      <operation type="okDialog" text="Collegare le sonde dell'oscilloscopio al jig come in figura" image="img/dcMotors/probes.jpg" />
      <operation type="okDialog" text="Collegare il motore al jig come in figura" image="img/dcMotors/yesEncoder.jpg" log="true"/>
    </test>

    <test id="2" name="Test rotazione motore">
      <operation type="passFailDialog" text="Alimentare il motore, il motore gira in senso orario?" />
    </test>
    
	<test id="3" name="Test lettura encoder">
      <operation type="yesNoDialog" text="Sull'oscilloscopio viene visualizzata una forma d'onda simile a quella in figura?" image="img/dcMotors/encoderWaveForm.jpg" />
    </test>
	
	<test id="4" name="Etichettatura">
      <operation type="okDialog" text="Applicare l'etichetta con il serial number sul motore come in figura.." image="img/dcMotors/label1.jpg" />
      <operation type="okDialog" text="Applicare un sottile strato di colla sotto la piegatura del flat e fissarlo con una fascetta come in figura.." image="img/dcMotors/label2.jpg" />
    </test>
     
  </testplan>

   <testplan id="10" board="DC MOTORS" iitcode="12264" reportsDir="dcMotors" rev="1">

    <test id="1" name="Connessioni Setup">
	  <operation type="okDialog" text="Preparazione setup di test..." image="img/dcMotors/setup.jpg" />
      <operation type="okDialog" text="Collegare ed impostare l'alimentatore come in figura" image="img/dcMotors/pws.jpg" />
      <operation type="okDialog" text="Collegare il motore al jig come in figura" image="img/dcMotors/noEncoder.jpg" />
    </test>

    <test id="2" name="Test rotazione motore">
      <operation type="passFailDialog" text="Alimentare il motore, il motore gira in senso orario?" />
    </test>
    		
	<test id="3" name="Etichettatura">
      <operation type="okDialog" text="Applicare l'etichetta con il serial number sul motore come in figura.." image="img/dcMotors/label1.jpg" />
      <operation type="okDialog" text="Applicare un sottile strato di colla sotto la piegatura del flat e fissarlo con una fascetta come in figura.." image="img/dcMotors/label2.jpg" />
    </test>
     
  </testplan>

	
      <!-- **************************************************************************************************
  
		TESTPLAN FOR BRUSHLESS MOTORS
  
       **************************************************************************************************-->
	   
   <testplan id="11" board="BRUSHLESS MOTORS" iitcode="10347" reportsDir="brushlessMotors" rev="2">


    <test id="1" name="Controllo visivo">
      <operation type="passFailDialog" text="Controllare visivamente lo stato del rotore e dello statore, vi é assenza di evidenti danni/difetti?" />
    </test>
    
	<test id="2" name="Controllo assenza cc">
      <operation type="passFailDialog" text="Verificare con il tester l'assenza di continuitá tra carcasse ed i fili nero/rosso/bianco , vi é assenza di continuitá?" />
    </test>
	
	<test id="3" name="Verifica valore avvolgimenti">
      <operation type="yesNoDialog" text="Verificare con il tester il valore resistivo degli avvolgimenti (nero/rosso e nero/bianco). I valori ricadono nel range come da tabella in figura?" image="img/brushlessMotors/valori.jpg" />
    </test>
	
	<test id="4" name="Verifica fasatura rotore">
      <operation type="yesNoDialog" text="Verificare con l'apposita carta magnetica verde la fasatura del rotore .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/fasatura.jpg" />
    </test>
	
	<test id="5" name="Verifica accoppiamento rotore / albero">
      <operation type="yesNoDialog" text="Verificare il corretto accoppiamento tra rotore ed albero .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/allineamento-albero-rotore.png" />
    </test>   
	
	<test id="6" name="Test sensori di hall">
	  <operation type="okDialog" text="Preparazione setup di test..." image="img/brushlessMotors/setup.jpg" />
      <operation type="okDialog" text="Asemblare statore e rotore con la meccanica di test, collegare quindi i fili al setup." image="img/brushlessMotors/assembly.jpg" />
      <operation type="yesNoDialog" text="Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Hall Sens. Muovendo a mano il rotore i valori sul display cambiano?" image="img/brushlessMotors/hall.jpg" />
    </test>
	
	<test id="8" name="Test motore">
      <operation type="yesNoDialog" text="1. Posizionare il motore come in figura.
	  
2. Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Move it.

3. Verificare che selezionando V+ -> rotazione in senso antiorario.

4. Verificare che selezionando V- -> rotazione in senso orario." image="img/brushlessMotors/motor.jpg" />
    </test>
     
  </testplan>
  
   <testplan id="12" board="BRUSHLESS MOTORS" iitcode="10350" reportsDir="brushlessMotors" rev="2">


    <test id="1" name="Controllo visivo">
      <operation type="passFailDialog" text="Controllare visivamente lo stato del rotore e dello statore, vi é assenza di evidenti danni/difetti?" />
    </test>
    
	<test id="2" name="Controllo assenza cc">
      <operation type="passFailDialog" text="Verificare con il tester l'assenza di continuitá tra carcasse ed i fili nero/rosso/bianco , vi é assenza di continuitá?" />
    </test>
	
	<test id="3" name="Verifica valore avvolgimenti">
      <operation type="yesNoDialog" text="Verificare con il tester il valore resistivo degli avvolgimenti (nero/rosso e nero/bianco). I valori ricadono nel range come da tabella in figura?" image="img/brushlessMotors/valori.jpg" />
    </test>
	
	<test id="4" name="Verifica fasatura rotore">
      <operation type="yesNoDialog" text="Verificare con l'apposita carta magnetica verde la fasatura del rotore .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/fasatura.jpg" />
    </test>
	   
	<test id="5" name="Verifica accoppiamento rotore / albero">
      <operation type="yesNoDialog" text="Verificare il corretto accoppiamento tra rotore ed albero .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/allineamento-albero-rotore.png" />
    </test> 

	<test id="6" name="Test sensori di hall">
	  <operation type="okDialog" text="Preparazione setup di test..." image="img/brushlessMotors/setup.jpg" />
      <operation type="okDialog" text="Asemblare statore e rotore con la meccanica di test, collegare quindi i fili al setup." image="img/brushlessMotors/assembly.jpg" />
      <operation type="yesNoDialog" text="Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Hall Sens. Muovendo a mano il rotore i valori sul display cambiano?" image="img/brushlessMotors/hall.jpg" />
    </test>
	
	<test id="7" name="Test motore">
      <operation type="yesNoDialog" text="1. Posizionare il motore come in figura.
	  
2. Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Move it.

3. Verificare che selezionando V+ -> rotazione in senso antiorario.

4. Verificare che selezionando V- -> rotazione in senso orario." image="img/brushlessMotors/motor.jpg" />
    </test>
     
  </testplan>

	<testplan id="13" board="BRUSHLESS MOTORS" iitcode="7117" reportsDir="brushlessMotors" rev="3">


		<test id="1" name="Controllo visivo">
			<operation type="passFailDialog" text="Controllare visivamente lo stato del rotore e dello statore, vi é assenza di evidenti danni/difetti?" />
		</test>

		<test id="2" name="Controllo assenza cc">
			<operation type="passFailDialog" text="Verificare con il tester l'assenza di continuitá tra carcasse ed i fili nero/rosso/bianco , vi é assenza di continuitá?" />
		</test>

		<test id="3" name="Verifica valore avvolgimenti">
			<operation type="yesNoDialog" text="Verificare con il tester il valore resistivo degli avvolgimenti (nero/rosso e nero/bianco). I valori ricadono nel range come da tabella in figura?" image="img/brushlessMotors/valori.jpg" />
		</test>

		<test id="4" name="Verifica fasatura rotore">
			<operation type="yesNoDialog" text="Verificare con l'apposita carta magnetica verde la fasatura del rotore .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/fasatura.jpg" />
		</test>

		<test id="5" name="Verifica accoppiamento rotore / albero">
			<operation type="yesNoDialog" text="Verificare il corretto accoppiamento tra rotore ed albero .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/allineamento-albero-rotore.png" />
		</test>

		<test id="6" name="Test motore">
			<operation type="yesNoDialog" text="1. Posizionare il motore come in figura.
	  
2. Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Move it.

3. Verificare che selezionando V+ -> rotazione in senso antiorario.

4. Verificare che selezionando V- -> rotazione in senso orario." image="img/brushlessMotors/motor.jpg" />
		</test>

	</testplan>

	<testplan id="14" board="BRUSHLESS MOTORS" iitcode="7116" reportsDir="brushlessMotors" rev="2">


		<test id="1" name="Controllo visivo">
			<operation type="passFailDialog" text="Controllare visivamente lo stato del rotore e dello statore, vi é assenza di evidenti danni/difetti?" />
		</test>

		<test id="2" name="Controllo assenza cc">
			<operation type="passFailDialog" text="Verificare con il tester l'assenza di continuitá tra carcasse ed i fili nero/rosso/bianco , vi é assenza di continuitá?" />
		</test>

		<test id="3" name="Verifica valore avvolgimenti">
			<operation type="yesNoDialog" text="Verificare con il tester il valore resistivo degli avvolgimenti (nero/rosso e nero/bianco). I valori ricadono nel range come da tabella in figura?" image="img/brushlessMotors/valori.jpg" />
		</test>

		<test id="4" name="Verifica fasatura rotore">
			<operation type="yesNoDialog" text="Verificare con l'apposita carta magnetica verde la fasatura del rotore .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/fasatura.jpg" />
		</test>

		<test id="5" name="Verifica accoppiamento rotore / albero">
			<operation type="yesNoDialog" text="Verificare il corretto accoppiamento tra rotore ed albero .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/allineamento-albero-rotore.png" />
		</test>

		<test id="6" name="Test motore">
			<operation type="yesNoDialog" text="1. Posizionare il motore come in figura.
	  
2. Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Move it.

3. Verificare che selezionando V+ -> rotazione in senso antiorario.

4. Verificare che selezionando V- -> rotazione in senso orario." image="img/brushlessMotors/motor.jpg" />
		</test>

	</testplan>

	<testplan id="15" board="BRUSHLESS MOTORS" iitcode="10182" reportsDir="brushlessMotors" rev="2">


		<test id="1" name="Controllo visivo">
			<operation type="passFailDialog" text="Controllare visivamente lo stato del rotore e dello statore, vi é assenza di evidenti danni/difetti?" />
		</test>

		<test id="2" name="Controllo assenza cc">
			<operation type="passFailDialog" text="Verificare con il tester l'assenza di continuitá tra carcasse ed i fili nero/rosso/bianco , vi é assenza di continuitá?" />
		</test>

		<test id="3" name="Verifica valore avvolgimenti">
			<operation type="yesNoDialog" text="Verificare con il tester il valore resistivo degli avvolgimenti (nero/rosso e nero/bianco). I valori ricadono nel range come da tabella in figura?" image="img/brushlessMotors/valori.jpg" />
		</test>

		<test id="4" name="Verifica fasatura rotore">
			<operation type="yesNoDialog" text="Verificare con l'apposita carta magnetica verde la fasatura del rotore .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/fasatura.jpg" />
		</test>

		<test id="5" name="Verifica accoppiamento rotore / albero">
			<operation type="yesNoDialog" text="Verificare il corretto accoppiamento tra rotore ed albero .  Si ha un risultato coerente alla figura?" image="img/brushlessMotors/allineamento-albero-rotore.png" />
		</test>



		<test id="6" name="Test motore">
			<operation type="yesNoDialog" text="1. Posizionare il motore come in figura.
	  
2. Con il joystick sinistro selezionare : Test Motors -> Brushless Motor -> Test Move it.

3. Verificare che selezionando V+ -> rotazione in senso antiorario.

4. Verificare che selezionando V- -> rotazione in senso orario." image="img/brushlessMotors/motor.jpg" />
		</test>

	</testplan>
</iCubProductionTestSuite>